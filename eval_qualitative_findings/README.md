# Grad-CAM and Laplacian Analysis Pipeline

This code generates heatmaps for real and fake images using two CNN models (`EfficientNetB0` and `MNASNet`), calculates their respective probabilities, and analyzes image sharpness using Laplacian scores. All results are organized into a structured output directory with an accompanying CSV file summarizing the data.

## How to Run

1. Run
   ```bash
   unzip -l Val_CNN.zip
2. Change your path (image path to analyse) in **first and second line** of gradcam_laplacian_to_csv.py.
3. Run the script in base directory:

   ```bash
   python eval_qualitative_findings/gradcam_laplacian_to_csv.py

## Directory Structure

After running the script, the output directory will look like this:

eval_qualitative_findings/
|-- EfficientNetB0/
|   |-- fake_heatmaps/   # Heatmaps for fake images generated by EfficientNetB0
|   |-- real_heatmaps/   # Heatmaps for real images generated by EfficientNetB0
|-- MNASNet/
|   |-- fake_heatmaps/   # Heatmaps for fake images generated by MNASNet
|   |-- real_heatmaps/   # Heatmaps for real images generated by MNASNet
|-- combined_probabilities_output.csv  # Summary CSV file containing probabilities and Laplacian scores



## Script Overview

### Features

1. **Heatmap Generation**:
   - Grad-CAM heatmaps are generated for all images using `EfficientNetB0` and `MNASNet` models.
   - Heatmaps are saved in the respective model's `real_heatmaps` or `fake_heatmaps` folder.

2. **Probability Calculation**:
   - Both `EfficientNetB0` and `MNASNet` calculate probabilities for "real" and "fake" classes.
   - Results are stored in the `combined_probabilities_output.csv` file.

3. **Laplacian Blur Score**:
   - The Laplacian variance of each image is calculated to assess sharpness.
   - Images with Laplacian scores in the range `[200, 2000]` are labeled as **real** (class `0`), and others as **fake** (class `1`).

4. **CSV Output**:
   - The CSV file `combined_probabilities_output.csv` includes:
     - Image Name
     - Image Label (based on directory: `0` for real, `1` for fake)
     - Real and Fake Probabilities for both models
     - Laplacian Score and Laplacian Label

---

## CSV File Format

The `combined_probabilities_output.csv` file has the following columns:

| Column Name                       | Description                                                                                     |
|-----------------------------------|-------------------------------------------------------------------------------------------------|
| **Image Name**                    | Name of the image file                                                                          |
| **Image Label**                   | `0` for real images, `1` for fake images (determined from directory: `Val_CNN/Real` or `Val_CNN/Fake`) |
| **EfficientNetB0 Real Probability** | Probability for real image class calculated by EfficientNetB0                                  |
| **EfficientNetB0 Fake Probability** | Probability for fake image class calculated by EfficientNetB0                                  |
| **MNASNet Real Probability**       | Probability for real image class calculated by MNASNet                                         |
| **MNASNet Fake Probability**       | Probability for fake image class calculated by MNASNet                                         |
| **Laplacian Score**                | Blurriness score calculated using Laplacian variance                                           |
| **Laplacian Label**                | `0` for real image (if Laplacian Score is between `[200, 2000]`), `1` for fake image otherwise  |

---

## Notes

- **Class 0**: Represents **real images**.
- **Class 1**: Represents **fake images**.
- The Laplacian score is used to determine image sharpness:
  - Score within `[200, 2000]` is classified as **real**.
  - Score outside this range is classified as **fake**.

---


